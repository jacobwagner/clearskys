# /etc/network/interfaces

# This file describes the network interfaces available on your system
# and how to activate them. For more information, see interfaces(5).

# The loopback network interface
auto lo
iface lo inet loopback

# {{ ubuntu.mgmt.primary_iface }} is manually configured, and slave to the "mgmt" bonded NIC
auto {{ ubuntu.mgmt.primary_iface }}
iface {{ ubuntu.mgmt.primary_iface }} inet manual
    bond-master {{ network.mgmt.bond_name }}
    bond-primary {{ ubuntu.mgmt.primary_iface }}

# {{ ubuntu.mgmt.secondary_iface }} ditto, thus creating a 2-link bond.
auto {{ ubuntu.mgmt.secondary_iface }}
iface {{ ubuntu.mgmt.secondary_iface }} inet manual
    bond-master {{ network.mgmt.bond_name }}

# {{ network.mgmt.bond_name }} is the bonding NIC and can be used like any other normal NIC.
# {{ network.mgmt.bond_name }} is configured using static network information.
auto {{ network.mgmt.bond_name }}
iface {{ network.mgmt.bond_name }} inet static
    address {{ ansible_default_ipv4.address }}
    netmask {{ network.netmask }}
    gateway {{ network.gateway }}
    dns-nameservers {{ network.dns.primary }} {{ network.dns.secondary }}
    dns-search {{ network.dns.search }}
    bond-slaves none
    bond-mode active-backup
    bond-miimon 100
    bond-downdelay 200
    bond-updelay 200

# {{ ubuntu.vmnet.primary_iface }} is manually configured, and slave to the "vmnet" bonded NIC
auto {{ ubuntu.vmnet.primary_iface }}
iface {{ ubuntu.vmnet.primary_iface }} inet manual
    bond-master {{ network.vmnet.bond_name }}
    bond-primary {{ ubuntu.vmnet.primary_iface }}

# {{ ubuntu.vmnet.secondary_iface }} ditto, thus creating a 2-link bond.
auto {{ ubuntu.vmnet.secondary_iface }}
iface {{ ubuntu.vmnet.secondary_iface }} inet manual
    bond-master {{ network.vmnet.bond_name }}

# {{ network.vmnet.bond_name }} is the bonding NIC and can be used like any other normal NIC.
# {{ network.vmnet.bond_name }} is configured using manual network information.
auto {{ network.vmnet.bond_name }}
iface {{ network.vmnet.bond_name }} inet manual
    up ip link set $IFACE up
    down ip link set $IFACE down
    bond-slaves none
    bond-mode active-backup
    bond-miimon 100
    bond-downdelay 200
    bond-updelay 200
